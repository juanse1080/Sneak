const requestUrl="https://api.unsplash.com/search/photos?query=london&client_id=ozSSrsBNNbC6KZm4X9QCpRBlM_nm6PXursiuRyTPTYo",urlSearchParams=new URLSearchParams(window.location.search),params=Object.fromEntries(urlSearchParams.entries()),defaultData=[{hash:window.location.hash||"#home",portfolio:params.portfolio||"all",view:params.view||"grid"},`page ${window.location.hash||"#home"}`,window.location.toString()];async function loadData(){setData(defaultData);const{portfolio:e,view:t}=defaultData[0],a=await getImages(requestUrl.replace("london",e));update({portfolio:e},document.getElementById("filters").querySelector(`[data-value="${e}"]`)),update({view:t},document.getElementById("views").querySelector(`[data-value="${t}"]`)),pushImage(a)}function loadEvents(){const e=document.getElementsByClassName("filter");for(let t=0;t<e.length;t++)e[t].addEventListener("click",async function(e){const{value:t}=e.target.dataset;update({portfolio:t},e.target),pushImage(await getImages(requestUrl.replace("london",t)))});const t=document.getElementsByClassName("view");for(let e=0;e<t.length;e++)t[e].addEventListener("click",function(e){const{value:t}=e.target.dataset;update({view:t},e.target)});const a=document.getElementById("bar");a.addEventListener("click",function(e){document.getElementById("bar-container").classList.toggle("d-flex")}),document.addEventListener("mousedown",function(e){e.target!==a&&document.getElementById("bar-container").classList.remove("d-flex")})}async function getImages(e){return loading(),fetch(e).then(e=>e.json()).then(e=>e.results)}function getData(){return JSON.parse(localStorage.getItem("data"))}function setData(e){localStorage.setItem("data",JSON.stringify(e))}function updateUrlParameter(e,t,a){var n=e.indexOf("#"),o=-1===n?"":e.substr(n);e=-1===n?e:e.substr(0,n);var i=new RegExp("([?&])"+t+"=.*?(&|$)","i"),r=-1!==e.indexOf("?")?"&":"?";return null===a?("?"===(e=e.replace(new RegExp("([?&]?)"+t+"=[^&]*","i"),"")).slice(-1)&&(e=e.slice(0,-1)),-1===e.indexOf("?")&&(e=e.replace(/&/,"?"))):e=e.match(i)?e.replace(i,"$1"+t+"="+a+"$2"):e+r+t+"="+a,e+o}function update(e,t){let a=getData(),{portfolio:n,view:o}=e,i=window.location.toString();const r=window.location.hash||a[0].hash;a[0].hash=r,n&&(i=updateUrlParameter(i,"portfolio",n),changeActive(document.getElementById("filters"),t),a[0].portfolio=n),o&&(i=updateUrlParameter(i,"view",o),changeActive(document.getElementById("views"),t),a[0].view=o);const l=[a[0],"page "+r,i];setData(l),history.pushState(...l)}function pushImage(e){const t=document.getElementById("images"),a=e.reduce((e,t,a)=>e+`\n    <div class="portfolio-grid-item item-${a}">\n      <div style="background-image: linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url(${t.urls.regular})" data-label="${t.alt_description}" class="responsive-img"></div>\n    </div>\n  `,"");t.innerHTML=a}function loading(){const e=document.getElementById("images"),t=new Array(10).fill(0).reduce((e,t,a)=>e+`\n    <div class="portfolio-grid-item item-${a}">\n      <div class="pulse"></div>\n    </div>\n  `,"");e.innerHTML=t}function changeActive(e,t){const a=e.querySelector(".active");a&&(a.ariaSelected="false",a.classList.remove("active")),t.ariaSelected="true",t.classList.add("active")}loadEvents(),loadData();